<!DOCTYPE html>
<html>
<head>
  <title>Electricity Chart</title>
  <!-- Include Chart.js library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@^2"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@^1"></script>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
<!-- Create a canvas element to render the line chart -->
<header>
  <h1>Appliance Electricity Consumption</h1>
  <p>Monitoring electricity usage for your appliance.</p>
</header>

<!-- Chart section -->
<div class="chart-container">
  <canvas id="lineChart" width="800" height="400"></canvas>
</div>

<!-- Filler content -->
<section class="filler-content">
  <h2>Consumption Data</h2>
  <p>This chart displays the electricity consumption data for your appliance over time. You can use it to track usage patterns and optimize energy efficiency.</p>
  <p>If there are any questions, contact me.</p>
</section>

<script>
  // Get the data passed from your Go server
  var jsonData = {{ .jsonData }};
  var data = JSON.parse(jsonData);

  // Extract timestamps and values from the data
  var timestamps = data.map(function(item) {
    return new Date(item.timestamp * 1000)
  });

  var values = data.map(function(item) {
    return item.value;
  });

  // Create a line chart
  var ctx = document.getElementById('lineChart').getContext('2d');
  var myChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: timestamps,
      datasets: [{
        label: 'Value',
        data: values,
        borderColor: 'blue',
        borderWidth: 1,
        fill: false
      }]
    },
    options: {
      responsive: false, // Disable auto-resizing for better control
      scales: {
        x: {
          type: 'time', // Use time scale for x-axis
          time: {
            unit: 'day', // Display data per day
            displayFormats: {
              day: 'MMM D' // Format for day display
            }
          },
          title: {
            display: true,
            text: 'Time'
          }
        },
        y: {
          title: {
            display: true,
            text: 'Consumption'
          }
        }
      }
    }
  });
</script>
</body>
</html>
